---
title: 'Роль React Server Components в современных приложениях'
category: 'REACT'
date: '2025-01-19'
excerpt: 'Cегодня речь пойдет о серверных компонентах реакта, паттернах их использования, возможностях  преимуществах и возможностях.'
first_text: 'Современная разработка веб-приложений активно развивается, и разработчики постоянно ищут новые подходы и инструменты для повышения производительности, улучшения пользовательского опыта и упрощения архитектуры приложений. Одним из таких инновационных изменений стали React Server Components (RSC), которые были анонсированы командой React в конце 2020 года.'
cover_image: '/images/posts/rsc.webp'
---

Современная разработка веб-приложений активно развивается, и разработчики постоянно
ищут новые подходы и инструменты для повышения производительности,
улучшения пользовательского опыта и упрощения архитектуры приложений.
Одним из таких инновационных изменений стали React Server Components (RSC),
которые были анонсированы командой React в конце 2020 года.
Этот новый подход привносит множество возможностей, значительно упрощая создание приложения
и улучшая его производительность. В данной статье мы рассмотрим роль React Server Components
в современных веб-приложениях, их основные преимущества и то, как они справляются с вызовами,
стоящими перед разработчиками.

## Что такое React Server Components?

React Server Components (RSC) — это компоненты, которые выполняются на сервере.
Этот подход немного отличается от привычного серверного рендера (SSR, Server-Side Rendering)
и статической генерации (SSG, Static Site Generation), предоставляя более гибкий механизм рендеринга компонентов.
Основная идея заключается в том, чтобы переносить тяжелые вычисления рендеринга и загрузки данных с клиента на сервер,
тем самым снижая нагрузку на клиент и ускоряя отображение контента.
Серверные компоненты рендерятся 1 раз, они иммутабельны, и никогда не изменяются. Например рассмотрим такой код

 ```jsx showLineNumbers
import React, { Suspense } from 'react';
import CategoryBar from '@/components/CategoryBar';
import { getCategories } from '@/services';
import classes from './page.module.css';
import Loader from '@/components/ui/Loader';

const CategoryLayout = async () => {
  const categories = await getCategories();
  return (
    <div className={classes.layout}>
      <Suspense fallback={<Loader />}>
        <CategoryBar categories={categories} />
      </Suspense>
    </div>
  );
};

export default CategoryLayout;
```

В данном примере у нас есть api, и мы запрашиваем категории статей для блога, чтобы отрендерить их.
Но ведь в компонентах React мы не можем делать сайд эффектов в самой функции,
для этого у нас есть хук `useEffect`, и тем более функциональные компоненты не могут быть
ассинхронными. Ключевым понятием здесь является то, что серверные компоненты не перерисовываются,
поэтому мы не можем использовать стандартные api реакта в них, такие как `useState` например, потому что
при изменении состояния компоненты реакта перерисовываются. Но при этом никто не ограничивает нас, сделать
какой то запрос на сервер прям внутри функции серверного компонента.

Раньше у нас небыло никаких ограничений на серверные и клиентские компоненты, были просто компоненты реакта.
Теперь же, старое понятие компонентов это - это клиентские компоненты, то есть компоненты которые могут
использовать хуки реакта, так же стоить отметить, что клиентские компоненты на самом деле могут рендериться
как на клиенте, так и на сервера.

## Есть ли разница между серверными компонентами и SSR ?

Серверные компоненты реакта НЕ РАВНО server side rendering. Мы по прежнему рендерим html на сервере
для того, чтобы пользователь не видел пустой экран, пока грузится js, и мы по прежнему получаем все
преимущества SEO при поиске наших приложений в популярных поисковиках. Стоит различать эти понятия,
еще раз - серверные компоненты выполняются НА СЕРВЕРЕ, они не входят в код, который будет исполнен браузером,
они разгружают трафик и самого клиента.

## Как и где использовать серверные компоненты ?

В моем понимании, серверные компоненты не могут использоваться без бандлера, и веб сервера, например express.
Наиболее простым способом попробовать серверные компоненты является next.js версии 13.4 и выше.
Команда реакта на своем официальном сайте <a href="https://react.dev/learn/start-a-new-react-project#bleeding-edge-react-frameworks" target="_blank" rel="noopener noreferrer">опубликовала статью</a>,
где описывается какие фреймворки поддерживают серверные компоненты.

## Как использовать клиентские компоненты вместе с серверными ?

В новой парадигме серверных компонентов, любой компонент который вы создает в next.js является
серверным по дефолту. Для того чтобы нам сделать компонент клиентским, мы должны написать директиву
`'use client'` вначале файла. Давайте например напишем компонент, который при переходе на новую страницу
всегда будет возвращать скролл наверх. Для этого нам понадобиться `useEffect`, поэтому код будем отправлять в браузер.

 ```jsx showLineNumbers
'use client';

import { usePathname } from 'next/navigation';
import { useEffect } from 'react';

export default function Scroll() {
  const pathname = usePathname();
  useEffect(() => {
    window.scroll(0, 0);
  }, [pathname]);
  return null;
}
 ```

Когда мы пишем серверные компоненты, нам не нужно писать `use server`. Next сам уже знает, что эти
компоненты серверные.
